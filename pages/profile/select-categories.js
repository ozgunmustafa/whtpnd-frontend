import React, {useState } from 'react'
import { Col, Modal, Row, Button, Input, Card } from 'antd'
import Head from 'next/head'
import Layout from '../../components/Layout'
import { Typography } from 'antd'
import Avvatar from '../../components/Avvatar'
import { Avatar } from 'antd'
import Link from 'next/link'
import { useDispatch, useSelector } from 'react-redux'
import {
  BookmarkIcon,
  BookmarkIconActive,
  CommentsIcon,
  ShareIcon,
  ShieldSvg
} from '../../components/CustomIcons'
import Icon, {
  InstagramOutlined,
  FacebookOutlined,
  TwitterOutlined,
  PlusOutlined,
  MinusOutlined,
  SearchOutlined,
  FormOutlined
} from '@ant-design/icons'
import ActionButton from '../../components/ActionButton'
import {
  followCategory,
  getAllCategories
} from '../../src/features/categories/categorySlice'
import {
  CategoryListPlaceHolder,
  PostPlaceholder
} from '../../components/Placeholders'

const { Title, Paragraph } = Typography

export default function SelectCategories() {
  const [userId, setUserId] = useState('')
  const dispatch = useDispatch()
  const { data, loading, error } = useSelector((state) => state.categories)

  React.useEffect(() => {
    dispatch(getAllCategories())
    setUserId(localStorage.getItem('userId'))
  }, [])


  const [feedCategories, setFeedCategories] = React.useState([
    {
      category: 'Marketing',
      category_img: 'https://robohash.org/accusantiumdoloremea.png'
    },
    {
      category: 'Research and Development',
      category_img: 'https://robohash.org/voluptasidofficiis.png'
    },
    {
      category: 'Engineering',
      category_img: 'https://robohash.org/aperiamvelnesciunt.png'
    },
    {
      category: 'Data Analyses',
      category_img: 'https://robohash.org/exdoloresquaerat.png'
    },
    {
      category: 'Programming',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Song',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Listen',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Podcast',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Marketing',
      category_img: 'https://robohash.org/accusantiumdoloremea.png'
    },
    {
      category: 'Research and Development',
      category_img: 'https://robohash.org/voluptasidofficiis.png'
    },
    {
      category: 'Engineering',
      category_img: 'https://robohash.org/aperiamvelnesciunt.png'
    },
    {
      category: 'Data Analyses',
      category_img: 'https://robohash.org/exdoloresquaerat.png'
    },
    {
      category: 'Programming',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Song',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Listen',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Podcast',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Marketing',
      category_img: 'https://robohash.org/accusantiumdoloremea.png'
    },
    {
      category: 'Research and Development',
      category_img: 'https://robohash.org/voluptasidofficiis.png'
    },
    {
      category: 'Engineering',
      category_img: 'https://robohash.org/aperiamvelnesciunt.png'
    },
    {
      category: 'Data Analyses',
      category_img: 'https://robohash.org/exdoloresquaerat.png'
    },
    {
      category: 'Programming',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Song',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Listen',
      category_img: 'https://robohash.org/nesciuntutest.png'
    },
    {
      category: 'Podcast',
      category_img: 'https://robohash.org/nesciuntutest.png'
    }
  ])
  const [isModalVisible, setIsModalVisible] = React.useState(false)
  const [shareUrl, setShareUrl] = React.useState('')
  const [expandTopics, setExpandTopics] = React.useState(false)
  const [modalType, setModalType] = React.useState('share')
  const [activeFeedComments, setActiveFeedComments] = React.useState([])



  const onChangeFollow = (item) => {
    dispatch(followCategory(item._id))
    setTimeout(() => {
      dispatch(getAllCategories())
    }, 500)
  }
  return (
    <>

      <Layout
        title="Create Next App"
        description="Generated by create next app"
        headerEnabled={true}
      >
        <Head>
          <title>Whthpnd | Homepage</title>
          <meta name="description" content="What Happened Home Page" />
        </Head>

        <section className="section-padding-1">
          <div className="container">
            <Row gutter={20}>
              <Col className="gutter-row  mb-3" xs={24} lg={15}>
                <section>
                  <Title level={4}>Explore</Title>

                  {data == null
                    ? [...Array(5)].map((item, index) => (
                        <CategoryListPlaceHolder
                          key={'placeholder-category' + index}
                        />
                      ))
                    : data?.data.map((item, index) => (
                        <Card
                          className="mb-1 category-list-card"
                          key={'category-card' + index}
                        >
                          <Row>
                            <Col xs={24} sm={20}>
                              <div className="d-flex flex-column">
                                <h4 className="fw-600 mb-0">
                                  <Link href="/">
                                    <a>{item.title}</a>
                                  </Link>{' '}
                                </h4>
                                <div className="d-flex text-muted">
                                  <small className="mr-1">22K Entries</small>
                                  <small className="mr-1">2K Followers</small>
                                </div>
                              </div>
                            </Col>
                            <Col xs={24} sm={4}>
                              {item.followers.includes(userId) ? (
                                <Button
                                  type="primary"
                                  style={{
                                    borderColor: '#14a800',
                                    backgroundColor: 'transparent',
                                    color: '#14a800',
                                    width: '100%'
                                  }}
                                  onClick={() => {
                                    onChangeFollow(item)
                                  }}
                                >
                                  Unfollow
                                </Button>
                              ) : (
                                <Button
                                  type="primary"
                                  style={{
                                    borderColor: '#14a800',
                                    backgroundColor: '#14a800',
                                    color: 'white',
                                    width: '100%'
                                  }}
                                  onClick={() => {
                                    onChangeFollow(item)
                                  }}
                                >
                                  Follow
                                </Button>
                              )}
                            </Col>
                          </Row>
                        </Card>
                      ))}

                  <PostPlaceholder />

                </section>
              </Col>
              <Col className="gutter-row mb-3" xs={24} lg={9}>
                <Input
                  size="large"
                  className="radius-pill mb-1"
                  placeholder="Ara"
                  prefix={
                    <SearchOutlined
                      style={{ fontSize: '20px', color: '#5c5c5c' }}
                    />
                  }
                />
                <section className="section-padding-1">
                  <Card className="topic-card">
                    <Row gutter={20}>
                      <Col className="gutter-row text-center" span={24}>
                        <div className="d-flex flex-column align-items-center mb-5">
                          <span className="prfl-avatar creator">
                            <Avatar
                              src="https://joeschmoe.io//api/v1/female/jana"
                              size={64}
                              className=""
                            />
                          </span>

                          <span
                            style={{ fontSize: '16px' }}
                            className="fw-600 lh-sm mb-1"
                          >
                            Mustafa Özgün
                          </span>
                          <span
                            style={{ fontSize: '14px' }}
                            className="text-muted lh-sm"
                          >
                            Velit culpa laborum laboris eu incididunt enim Lorem
                            cupidatat id irure.
                          </span>
                        </div>
                      </Col>
                    </Row>
                    <Row gutter={20} className="mb-3">
                      <Col className="gutter-row text-center" span={8}>
                        <Title level={5} className="lh-sm mb-0">
                          65K
                        </Title>
                        <p className="text-muted mb-0">Entries</p>
                      </Col>
                      <Col className="gutter-row text-center" span={8}>
                        <Title level={5} className="lh-sm mb-0">
                          5K
                        </Title>
                        <p className="text-muted mb-0">Followers</p>
                      </Col>
                      <Col className="gutter-row  text-center" span={8}>
                        <Title level={5} className="lh-sm mb-0">
                          232
                        </Title>
                        <p className="text-muted mb-0">Following</p>
                      </Col>
                    </Row>
                    <Row gutter={20}>
                      <Col className="gutter-row text-center" span={24}>
                        <Button
                          icon={<FormOutlined />}
                          shape="circle"
                          style={{ marginRight: '5px' }}
                        ></Button>
                        <Button shape="round">Follow</Button>
                      </Col>
                    </Row>
                  </Card>
                </section>

                <section className="section-padding-1">
                  <ul
                    className={
                      'highlight-topics ' + (expandTopics ? 'expanded ' : '')
                    }
                  >
                    {feedCategories.map((category, index) => (
                      <li key={index + 'c'}>
                        <a href="">{category.category}</a>
                      </li>
                    ))}
                  </ul>
                  <Button
                    type="text"
                    className="w-100 "
                    icon={expandTopics ? <MinusOutlined /> : <PlusOutlined />}
                    onClick={() => {
                      setExpandTopics(!expandTopics)
                    }}
                  >
                    Daha {expandTopics ? 'Az' : 'Fazla'}
                  </Button>
                </section>
                <section className="section-padding-2">
                  <Title level={5}>Following</Title>
                  {[...Array(5)].map((e, i) => (
                    <Link href="/profile" key={'profile' + i}>
                      <a>
                        <div className="mb-2">
                          <Avvatar
                            key={i}
                            size={30}
                            src={`https://joeschmoe.io//api/v1/male/jack`}
                            text="Nich Babich"
                            style={{
                              minWidth: '30px',
                              backgroundColor: '#d1d1d1',
                              fontSize: '12px'
                            }}
                          />
                        </div>
                      </a>
                    </Link>
                  ))}
                </section>

                <div className="card-padding-responsive radius-1  d-flex align-items-center">
                  <ul className="custom-list text-muted d-flex flex-wrap justify-content-center">
                    <li>
                      <a href="">About</a>
                    </li>
                    <li>
                      <a href="">Contact</a>
                    </li>
                    <li>
                      <a href="">Help</a>
                    </li>
                    <li>
                      <a href="">Community</a>
                    </li>
                    <li>
                      <a href="">Policy</a>
                    </li>
                    <li>
                      <a href="">Blog</a>
                    </li>
                    <li>
                      <a href="">Terms</a>
                    </li>
                    <li>
                      <a href="">Career</a>
                    </li>
                  </ul>
                </div>
              </Col>
            </Row>
          </div>
        </section>
      </Layout>
    </>
  )
}
